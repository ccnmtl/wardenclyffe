{% load waffle_tags %}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>Youtube Video Upload</title>
	<link rel="stylesheet" href="{{STATIC_URL}}css/wardenclyffe.css" media="screen" />
	<link rel="stylesheet" href="{{STATIC_URL}}css/print.css" media="print" />
	<link rel="shortcut icon" href="{{STATIC_URL}}img/favicon.ico" type="image/x-icon" />
    {% include 'main/jquery.html' %}

  <script src="{{STATIC_URL}}s3sign/js/s3upload.js"></script>

</head>
<body class="one_column fixed">
{% flag allow_uploads %}
<div id="container">
<div id="youtubeheader">
</div>

<div id="content">
<h1>Submit a video to Columbia on YouTube EDU</h1>

<p>Welcome, <b>{% if user.first_name %}{{user.first_name}}
  {{user.last_name}}{% else %}{{user.username}}{% endif %}</b>.</p>

<p>Please use the form below to upload your video to Columbia's
  YouTube channel. <br />
<i>Videos files must be smaller than 2GB.</i></p>


<form action="{% url 'youtube-post' %}" method="post" enctype="multipart/form-data">

    <div id="vitaldropform">
        <p id="status"><b>Please select a file</b></p>
        <input type="file" id="file" onchange="s3_upload();" accept=".mov,.avi,.mp4,.flv,.mpg,.wmv,.m4v,.mp3" />
        <input type="hidden" name="s3_url" id="uploaded-url" />
        
<p><b>Title</b></p>
<p><input type="text" name="title" /></p>

<p><b>Description</b></p>
<p><textarea name="description" rows="5" cols="70"></textarea></p>



<input type="submit" value="upload" id="submit" disabled="disabled" />
</div>
</form>
</div>
</div>

<script>
function s3_upload() {
    var s3upload = new S3Upload({
        file_dom_selector: 'file',
        s3_sign_put_url: '/sign_s3/',
        s3_object_name: $('#file')[0].value,
        onProgress: function(percent, message) {
            $('#status').html('Upload progress: ' + percent + '%' + message);
        },
        onFinishS3Put: function(url) {
            $('#uploaded-url').val(url);
            $("#submit").removeAttr("disabled");            
        },
        onError: function(status) {
            $('#status').html('Upload error: ' + status);
        }
    });
}
</script>

{% else %}
{% include 'main/maintenance_mode.html' %}
{% endflag %}
</body>
</html>
